# Service Repo for Mercury Package Manager
## Data Service Created by Andrew Feikema
## Email Service HTML and CSS by Emily Costa
Mercury Package Manager is an app for Calvin University aiding in logging packages for on-campus residents and notifying the resident when a package has arrived for them.

Learn more about our project here: [github.com/calvin-cs262-fall2020-teamA/Project](https://github.com/calvin-cs262-fall2020-teamA/Project)

This is our data service repo, where you can find our database schema and sample queries.

The API Service provides CRUD Functionality for 'Package' and 'Person' tables.

# Database Schema Tables

## Package Fields

* `ID` - **integer**: 6-digit unique package identifier
* `DeskID` - **integer**: 3-digit package identifier for deskie/recipient use
* `Recipient` - **varchar**: reference of emailPrefix for recipient. e.g. (ajf34)
* `Desk` - **varchar**: Code abbreviation of related building. e.g. (KHVR)
* `Status` - **varchar**: Word describing package status. e.g. (Received)
* `EnteredTime` - **timestamp**: time at which deskie entered package
* `EnteredDeskie` - **varchar** reference of emailPrefix for deskie who entered package. e.g. (ajf34)
* `ReceivedTime` - **timestamp**: time at which intended recipient receives package
* `ReceivedDeskie` - **varchar** reference of emailPrefix for deskie who gave package to intended recipient
* `Size` - **varchar**: Physical description provided by deskie. e.g. (Small)
* `Color` - **varchar**: Physical description provided by deskie. e.g. (Brown)
* `Type` - **varchar**: Physical description provided by deskie. e.g. (Envelope)

## Person Fields

* `firstname` - **varchar**: e.g. (Andrew)
* `lastname` - **varchar**: e.g. (Feikema)
* `ResidentHall` - **varchar**: e.g. (Schulze)
* `ResidentRoom` - **varchar**: e.g. (268)
* `isDeskie` - **boolean**: determines access to package management features

# API Methods

## Create (POST):

### Package

* `/package` - Create package by providing all fields listed above except ID, DeskID, EnteredTime (which are generated by remote service). Triggers SMTP process to notify recipient of a new package via email.

  * `receivedtime`, `receiveddeskie`, `size`, `color`, and `type` fields are optional.

  * Sample HTTP Request:

    ```
    POST  https://still-falls-53764.herokuapp.com/package

    Content-Type: application/json

    {"recipient":"ajf34","desk":"SE","status":"Entered",
    "entereddeskie":"bjd47",
    "size":"Medium","color":"Brown","type":"Box"}
    ```

  * Returns: *

## Read (GET):

### Package:

#### For all four methods, including any value for the `persondata` param returns the associated recipient's data

* `/package/:id` - Access package by **universal** id

  * e.g. https://still-falls-53764.herokuapp.com/package/1?persondata=true

* `/packages/:dorm/:state` - Access packages in dorm by `dorm` (Desk) and `state` (Status). Allows filtering query params for a recipient. Providing a `deskid` (DeskID) for a package unique to the desk returns one package. Filtering for package appearance types (size, color, type) to be handled on the front end.

  * e.g. https://still-falls-53764.herokuapp.com/packages/SE/Archived?recipient=ajf34

* TEMP: `/packages` - temporary access pattern for all packages in database

  * e.g. https://still-falls-53764.herokuapp.com/packages?persondata=true

* TEMP: `/packages/:state` - temporary access pattern for all packages in database of some Status `state` (e.g. 'Archived' )

  * e.g. https://still-falls-53764.herokuapp.com/packages/Archived

### Person:

* `/person/:id` - access person data by email prefix `id` (emailPrefix) (e.g. ajf34)

  * e.g. https://still-falls-53764.herokuapp.com/person/ajf34

* `/people/hall/:hall` - access all people by a specific hall (e.g. 'SZ' for Schultze).

  * https://still-falls-53764.herokuapp.com/people/hall/SZ

* `/people/desk/:desk` - access all people who receive packages at a specific desk (e.g. 'SE' for Schultze-Eldersveld).

  * https://still-falls-53764.herokuapp.com/people/desk/SE

* TEMP: `/people` - temporary access pattern for all people in database

  * e.g. https://still-falls-53764.herokuapp.com/people

## Update (PUT):

### Person

* `/person/:id`: Edit any field(s) of a person accessed by emailPrefix with new value as query parameter

  * Sample HTTP Request:

     `PUT  https://still-falls-53764.herokuapp.com/person/ajf34?residentRoom=223&isDeskie=true`


### Package

* `/package/:id`: Edit any field(s) of a person accessed by emailPrefix with new value as query parameter

  * Sample HTTP Request:

     `PUT  https://still-falls-53764.herokuapp.com/package/1?size=Medium&color=Brown`

  * Note: Fields in query parameters are accepted as **lowercase**

## Delete (DELETE):

* No Delete capabilities are expected to be provided to end users in the initial release. All package data will be categorized as 'Archived' instead of deleted entirely.